const _0x3db8f5=_0x44d4;!function(t,e){const o=_0x44d4,a=_0x9c0d();for(;;)try{if(437335===parseInt(o(540))/1*(parseInt(o(332))/2)+-parseInt(o(278))/3+-parseInt(o(350))/4*(parseInt(o(535))/5)+parseInt(o(498))/6+parseInt(o(486))/7+-parseInt(o(272))/8*(parseInt(o(277))/9)+parseInt(o(333))/10)break;a.push(a.shift())}catch(t){a.push(a.shift())}}();import*as _0x43581d from"three";import{OrbitControls}from"https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/controls/OrbitControls.js";import{EffectComposer}from"https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/EffectComposer.js";import{RenderPass}from"https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/RenderPass.js";import{AfterimagePass}from"https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/postprocessing/AfterimagePass.js";import{makeMat}from"./mins.js";document[_0x3db8f5(499)](_0x3db8f5(326),(function(t){const e=_0x3db8f5;("F12"===t.key||t.ctrlKey&&t[e(387)]&&("I"===t[e(479)]||"J"===t.key)||t.ctrlKey&&"U"===t[e(479)])&&(t.preventDefault(),location=atob(e(388)))})),document[_0x3db8f5(499)](_0x3db8f5(324),(function(t){t[_0x3db8f5(339)]()}));let devx=!1;setInterval((()=>{const _0x200f24=_0x3db8f5,_0x46ad57=(new Date).getTime();eval("debugger;");const _0x364de8=(new Date)[_0x200f24(391)](),_0x25aae9=_0x364de8-_0x46ad57>100;_0x25aae9&&!devx&&(devx=!0,document.body[_0x200f24(509)]=_0x200f24(382)),!_0x25aae9&&devx&&location[_0x200f24(443)]()}),1e3),window[_0x3db8f5(374)]||(window[_0x3db8f5(374)]={data:{messages:[_0x3db8f5(424)," mãi yêu em "],images:[],heartColor:_0x3db8f5(353)}}),function(){const t=_0x3db8f5,e=new URLSearchParams(window.location.search).get("id");if(e)try{const o=decodeURIComponent(escape(atob(e))),a=JSON[t(257)](o);if(window.Heartlove={data:{messages:a[t(442)]||[],images:a[t(505)]||[],heartColor:a[t(375)]||t(353),music:a[t(313)]||null}},console.log(t(357),window[t(374)]),window[t(374)].data[t(313)]){const e=new Audio(window[t(374)][t(460)][t(313)]);e[t(398)]=!0;const o=document.createElement(t(515));o.id=t(481),o[t(509)]=t(415),document.body[t(245)](o);let a=!1;const s=()=>{const e=t;o[e(509)]='<i class="fas '+(a?e(454):"fa-volume-xmark")+e(402)},r=()=>{const o=t;e.play()[o(299)]((()=>{a=!0,s()}))[o(494)]((()=>{const t=o;console[t(404)](t(268))}))},n=()=>{e.pause(),a=!1,s()};o[t(499)](t(414),(()=>{a?n():r()})),e[t(513)]()[t(299)]((()=>{a=!0,s()})).catch((()=>{const e=()=>{const t=_0x44d4;r(),document[t(519)](t(414),e)};document[t(499)]("click",e)}))}}catch(e){console[t(269)](t(378),e),window[t(374)]=null}else console[t(343)](t(290))}();const appData=window[_0x3db8f5(374)].data;let allWordsFlat=[];const originalTexts=appData[_0x3db8f5(442)]||[];originalTexts[_0x3db8f5(468)]((t=>{const e=_0x3db8f5,o=t[e(351)](" ");allWordsFlat[e(471)](...o)}));let currentWordIndex=0,nextWordSpawnTime=0;const WORD_SPAWN_INTERVAL=.4,IMAGE_CONFIG={paths:appData[_0x3db8f5(505)]||[],count:appData[_0x3db8f5(505)]?.length||0,scale:2.5,glowIntensity:.4,spawnRate:.18,maxActiveImages:45,spawnInterval:400};console[_0x3db8f5(404)](_0x3db8f5(274),IMAGE_CONFIG);const useCustomColor=appData.heartColor&&/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6})$/.test(appData.heartColor),heartInitialColor=new(_0x43581d[_0x3db8f5(400)])(useCustomColor?appData[_0x3db8f5(375)]:"#ff69b4");let imageTextures=[],imageLoadingComplete=!1,imagePool=[],activeImages=new Map,freeImageIndices=[],currentImageIndex=0,lastImageSpawnTime=0,imageSpawnQueue=[],minActiveImages=8,maxConcurrentImages=24,lastStatusLogTime=0,independentImageSprites=[],nextIndependentSpawnTime=0;const textureLoader=new(_0x43581d[_0x3db8f5(305)]),veras=document.getElementById(atob(_0x3db8f5(242)));async function fetchAndPrepareImageTextures(){try{const t=IMAGE_CONFIG.paths.map((t=>new Promise(((e,o)=>{const a=_0x44d4;textureLoader[a(413)](t,(t=>{const o=a;t.minFilter=_0x43581d[o(408)],t[o(386)]=_0x43581d[o(408)],t[o(458)]=_0x43581d[o(423)],t[o(497)]=!0,e(t)}),void 0,(t=>{const o=a,s=document.createElement(o(495));s[o(263)]=s.height=512;const r=s.getContext("2d"),n=r[o(311)](256,256,0,256,256,256);n[o(459)](0,o(331)),n[o(459)](1,o(320)),r.fillStyle=n,r[o(328)](0,0,512,512);const i=new(_0x43581d[o(286)])(s);i[o(497)]=!0,e(i)}))}))));return imageTextures=await Promise.all(t),!0}catch(t){return!1}}function buildImageSpriteMaterial(t,e=1){return new _0x43581d.SpriteMaterial({map:t,transparent:!0,opacity:e,depthWrite:!1,alphaTest:.1,sizeAttenuation:!0})}function getAspectRatioAdjustedScale(t,e=2.5){const o=_0x3db8f5;if(!t||!t[o(528)])return e;const a=t[o(528)][o(263)]/t[o(528)][o(469)];return{x:a>1?e:e*a,y:a>1?e/a:e}}async function setupImageStreaming(){imageLoadingComplete=await fetchAndPrepareImageTextures(),imageLoadingComplete&&tweakSpawnParametersByImageCount()}function tweakSpawnParametersByImageCount(){const t=_0x3db8f5,e=IMAGE_CONFIG.count;e<=2?(IMAGE_CONFIG[t(335)]=300,minActiveImages=6,maxConcurrentImages=Math.min(15,7.5*e)):e<=5?(IMAGE_CONFIG[t(335)]=400,minActiveImages=8,maxConcurrentImages=Math[t(358)](18,3.5*e)):(IMAGE_CONFIG[t(335)]=500,minActiveImages=8,maxConcurrentImages=Math.min(30,Math[t(416)](2.5*e)))}function printImageSystemReport(){const t=_0x3db8f5;activeImages.size,independentImageSprites[t(484)],freeImageIndices.length,imageSpawnQueue[t(484)]}function setupImageObjectPool(){const t=_0x3db8f5;if(imageLoadingComplete&&streamHeart){imagePool[t(468)]((e=>{const o=t;e&&e[o(361)]&&e[o(361)][o(411)](e)})),imagePool.length=0,activeImages[t(506)](),freeImageIndices.length=0;for(let e=0;e<IMAGE_CONFIG[t(380)];e++){const o=e%IMAGE_CONFIG[t(427)],a=imageTextures[o],s=buildImageSpriteMaterial(a,1),r=new _0x43581d.Sprite(s),n=getAspectRatioAdjustedScale(a,IMAGE_CONFIG[t(407)]);r.scale[t(254)](n.x,n.y,1),r[t(243)]=!1,r[t(261)]={poolIndex:e,textureIndex:o,isActive:!1,particleIndex:-1,aspectScale:n},streamHeart[t(356)](r),imagePool[t(471)](r),freeImageIndices[t(471)](e)}}}function retrieveImageFromPool(t){const e=_0x3db8f5;if(0===freeImageIndices[e(484)])return null;const o=freeImageIndices[e(246)](),a=imagePool[o],s=currentImageIndex%IMAGE_CONFIG[e(427)],r=imageTextures[s];a.material[e(472)]=r,a[e(240)][e(497)]=!0;const n=getAspectRatioAdjustedScale(r,IMAGE_CONFIG[e(407)]);return a[e(407)][e(254)](n.x,n.y,1),a[e(261)]={...a[e(261)],aspectScale:n,textureIndex:s,isActive:!0,particleIndex:t},activeImages[e(254)](t,o),currentImageIndex=(currentImageIndex+1)%IMAGE_CONFIG[e(427)],a}function releaseImageToPool(t){const e=_0x3db8f5,o=activeImages[e(446)](t);if(void 0!==o){const a=imagePool[o];a.visible=!1,a[e(240)][e(317)]=0,a[e(261)][e(271)]=!1,a[e(261)][e(346)]=-1,activeImages[e(285)](t),freeImageIndices[e(471)](o)}}function controlImageSpawningLogic(t){const e=_0x3db8f5,o=activeImages[e(279)]+independentImageSprites[e(484)],a=o<minActiveImages,s=t-lastImageSpawnTime>=IMAGE_CONFIG[e(335)]&&o<maxConcurrentImages;if(!a&&!s)return;(a||t>=nextIndependentSpawnTime)&&createFloatingImageSprite(t);let r=selectBestParticleForImageSpawn();-1!==r&&freeImageIndices[e(484)]>0&&(imageSpawnQueue[e(471)]({particleIndex:r,imageIndex:currentImageIndex%IMAGE_CONFIG.count,spawnTime:t,isForced:a}),currentImageIndex=(currentImageIndex+1)%IMAGE_CONFIG.count,lastImageSpawnTime=t)}function createFloatingImageSprite(t){const e=_0x3db8f5,o=Math.ceil(.8*maxConcurrentImages);if(independentImageSprites[e(484)]>=o)return;const a=currentImageIndex%IMAGE_CONFIG[e(427)],s=imageTextures[a],r=buildImageSpriteMaterial(s,1),n=new(_0x43581d[e(319)])(r),i=getAspectRatioAdjustedScale(s,IMAGE_CONFIG[e(407)]);n[e(407)][e(254)](i.x,i.y,1),n[e(243)]=!1,n[e(261)]={isIndependent:!0,imageIndex:a,spawnTime:t,lifeDuration:6e3+2e3*Math[e(465)](),startY:planeYCenter,startX:0,startZ:0,aspectScale:i},streamHeart.add(n),independentImageSprites[e(471)](n),currentImageIndex=(currentImageIndex+1)%IMAGE_CONFIG[e(427)],lastImageSpawnTime=t,nextIndependentSpawnTime=t+1.2*IMAGE_CONFIG[e(335)]}function animateFloatingImageSprites(t){const e=_0x3db8f5;for(let o=independentImageSprites.length-1;o>=0;o--){const a=independentImageSprites[o],s=a[e(261)],r=(t-s[e(430)])/s.lifeDuration;if(r>=1){streamHeart[e(411)](a),independentImageSprites[e(512)](o,1);continue}a[e(243)]=!0;const n=1-Math[e(323)](1-r,2),i=planeYCenter,d=10+4*Math[e(527)](r*Math.PI*2),l=_0x43581d[e(312)][e(524)](i,d,n),c=1.5+s[e(336)]%5*.3,x=s[e(336)]%2==0?1:-1,_=r*c*Math.PI*2*x,m=(1-n)*(6+3*Math[e(527)](s.imageIndex)),f=Math.cos(_)*m,b=Math[e(527)](_)*m;if(a[e(480)].set(f,l,b),r<.1){a.material[e(317)]=r/.1;const t=s[e(354)]||{x:IMAGE_CONFIG[e(407)],y:IMAGE_CONFIG[e(407)]};a[e(407)][e(254)](t.x*(.5+5*r),t.y*(.5+5*r),1)}else if(r>.4){const t=(r-.4)/.6;a.material[e(317)]=1-t;const o=1-.9*t,s=a[e(261)][e(354)]||{x:IMAGE_CONFIG[e(407)],y:IMAGE_CONFIG[e(407)]};a[e(407)][e(254)](s.x*o,s.y*o,1),t>.9&&(a[e(243)]=!1)}else{a[e(240)][e(317)]=1;const t=s[e(354)]||{x:IMAGE_CONFIG[e(407)],y:IMAGE_CONFIG[e(407)]};a[e(407)][e(254)](t.x,t.y,1)}}}function selectBestParticleForImageSpawn(){const t=_0x3db8f5,e=[];for(let o=0;o<streamCount;o++)if(!activeImages[t(500)](o)){const t=streamState[o];e.push({index:o,state:t,priority:t===STATE_ASCEND?3:t===STATE_ON_DISK?2:1})}return 0===e.length?-1:(e[t(347)](((e,o)=>o[t(485)]-e.priority)),e[0][t(536)])}function handleQueuedImageSpawns(){const t=_0x3db8f5;for(;imageSpawnQueue[t(484)]>0;){const{particleIndex:e,imageIndex:o}=imageSpawnQueue.shift();!activeImages.has(e)&&freeImageIndices[t(484)]>0&&retrieveImageFromPool(e)}}function applyMobileSpecificSettings(){const t=_0x3db8f5;if(!document[t(291)](t(438))){const e=document[t(537)](t(507));e[t(444)]=t(433),e[t(534)]=t(359),document[t(440)][t(245)](e)}document[t(462)].style[t(384)]=t(508),document[t(462)][t(270)][t(480)]=t(280),document[t(462)].style[t(263)]="100%",document[t(462)][t(270)][t(469)]=t(477),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i[t(327)](navigator[t(514)])&&renderer[t(298)](Math[t(358)](window[t(348)],2))}veras||(location[_0x3db8f5(379)]=atob(_0x3db8f5(516))),setupImageStreaming();let STAR_COUNT=0,starAlpha=null,starPhase=null,starGeo=null;const RingText=[...appData[_0x3db8f5(442)]];let cameraAnimationStart=null;const CAMERA_ANIMATION_DURATION=2.5;let CAMERA_START_POSITION={x:0,y:90,z:30};const CAMERA_END_POSITION={x:0,y:25,z:65};let userHasMovedCamera=!1,streamHeartStarted=!1,streamHeartActiveRatio=0,firstResetCompleted=!1;const scene=new(_0x43581d[_0x3db8f5(304)]),heartScene=new(_0x43581d[_0x3db8f5(304)]),renderer=new _0x43581d.WebGLRenderer({antialias:!0,alpha:!0}),HEART_ROTATE=!1;let heartbeatEnabled=!1;const rent=atob(_0x3db8f5(242)),fadeObjects=[],explosionEffects=[],effectPool={waves:[],sparkles:[],texts:[]},POOL_SIZE=5,activeTexts=new Map;let isPulsing=!1,pulseStartTime=0;const PULSE_DURATION=.6,PULSE_AMPLITUDE=.15;let revealStart=null;const REVEAL_DURATION=1.5,HEARTBEAT_FREQ_HZ=.5,HEARTBEAT_AMPLITUDE=.05,STAGE={RIBBON:0,STREAM:1,STAR:2,SHOOT:3,HEART:4},STAGE_DURATION=.15;renderer[_0x3db8f5(298)](window.devicePixelRatio),renderer[_0x3db8f5(289)](window[_0x3db8f5(526)],window[_0x3db8f5(504)]),document[_0x3db8f5(462)][_0x3db8f5(245)](renderer[_0x3db8f5(403)]),applyMobileSpecificSettings();let staticBottomHeart=null,staticTopHeart=null;const camera=new(_0x43581d[_0x3db8f5(393)])(45,window[_0x3db8f5(526)]/window[_0x3db8f5(504)],.1,300);camera[_0x3db8f5(480)].set(0,90,25),camera[_0x3db8f5(281)](0,0,0);const controls=new OrbitControls(camera,renderer[_0x3db8f5(403)]);controls[_0x3db8f5(533)]=!0,controls.minDistance=5,controls[_0x3db8f5(431)]=100,controls.enableZoom=!0,controls[_0x3db8f5(292)]=_0x43581d[_0x3db8f5(312)].degToRad(60),controls[_0x3db8f5(530)]=_0x43581d[_0x3db8f5(312)][_0x3db8f5(340)](135),controls[_0x3db8f5(371)]=!0;const planeGeo1=new(_0x43581d[_0x3db8f5(523)])(30,30),planeMat=new _0x43581d.MeshBasicMaterial({color:16711935,side:_0x43581d[_0x3db8f5(488)],visible:!1}),invisiblePlane=new(_0x43581d[_0x3db8f5(337)])(planeGeo1,planeMat);invisiblePlane[_0x3db8f5(255)].z=Math.PI,invisiblePlane.position.y=10,scene[_0x3db8f5(356)](invisiblePlane);const composerMain=new EffectComposer(renderer),renderPassMain=new RenderPass(scene,camera);renderPassMain[_0x3db8f5(506)]=!1,composerMain[_0x3db8f5(252)](renderPassMain);const composerHeart=new EffectComposer(renderer);composerHeart[_0x3db8f5(252)](new RenderPass(heartScene,camera));const afterimagePass=new AfterimagePass;afterimagePass[_0x3db8f5(266)][_0x3db8f5(473)].value=.9,composerHeart[_0x3db8f5(252)](afterimagePass),scene[_0x3db8f5(356)](new(_0x43581d[_0x3db8f5(302)])(16777215,.6));const p1=new(_0x43581d[_0x3db8f5(531)])(16777215,1.2);p1.position[_0x3db8f5(254)](10,10,10),scene[_0x3db8f5(356)](p1);const p2=new(_0x43581d[_0x3db8f5(531)])(16738047,.8);function generateGlowCircleTexture(){const t=_0x3db8f5,e=document.createElement(t(495));e[t(263)]=256,e[t(469)]=256;const o=e[t(364)]("2d"),a=128,s=o[t(311)](a,a,.4*127,a,a,127);s.addColorStop(0,t(434)),s[t(459)](1,"rgba(255,20,147,0)"),o[t(307)]=s,o[t(394)](),o[t(334)](a,a,127,0,2*Math.PI),o[t(349)](),o.fill();const r=o[t(311)](a,a,0,a,a,76.2);r[t(459)](0,t(244)),r[t(459)](1,"rgba(255,255,255,0)"),o[t(307)]=r,o.beginPath(),o[t(334)](a,a,76.2,0,2*Math.PI),o.closePath(),o[t(493)]();const n=new _0x43581d.CanvasTexture(e);return n[t(510)]=_0x43581d[t(408)],n.magFilter=_0x43581d[t(408)],n[t(497)]=!0,n}p2[_0x3db8f5(480)][_0x3db8f5(254)](-10,-10,-10),scene[_0x3db8f5(356)](p2);const circleTexture=generateGlowCircleTexture(),heartShape=new(_0x43581d[_0x3db8f5(538)]),x=0,y=0;heartShape[_0x3db8f5(406)](5,5),heartShape.bezierCurveTo(5,5,4,0,0,0),heartShape[_0x3db8f5(529)](-6,0,-6,7,-6,7),heartShape[_0x3db8f5(529)](-6,11,-3,15.4,5,19),heartShape[_0x3db8f5(529)](12,15.4,16,11,16,7),heartShape[_0x3db8f5(529)](16,7,16,0,10,0),heartShape[_0x3db8f5(529)](7,0,5,5,5,5);const polyPts=heartShape[_0x3db8f5(461)](100);function isPointInsidePolygon(t,e){const o=_0x3db8f5;let a=!1;for(let s=0,r=e[o(484)]-1;s<e[o(484)];r=s++){const o=e[s].x,n=e[s].y,i=e[r].x,d=e[r].y;n>t.y!=d>t.y&&t.x<(i-o)*(t.y-n)/(d-n)+o&&(a=!a)}return a}const polyShift=polyPts.map((t=>({x:t.x-5,y:t.y-7}))),BORDER_THRESHOLD=.1*(Math[_0x3db8f5(383)](...polyPts.map((t=>t.x)))-Math.min(...polyPts[_0x3db8f5(472)]((t=>t.x))));function calculateMinimumDistanceToBorder(t,e){const o=_0x3db8f5;let a=1/0;for(let s=0;s<polyShift.length;s++){const r=polyShift[s],n=polyShift[(s+1)%polyShift.length],i=n.x-r.x,d=n.y-r.y,l=((t-r.x)*i+(e-r.y)*d)/(i*i+d*d),c=Math[o(383)](0,Math[o(358)](1,l)),x=(t-(r.x+c*i))**2+(e-(r.y+c*d))**2;x<a&&(a=x)}return Math.sqrt(a)}const raycaster=new _0x43581d.Raycaster,mouse=new(_0x43581d[_0x3db8f5(426)]),HEART_CENTER_TARGET=new _0x43581d.Vector3(0,10,0);function createHeartExplosion(t){const e=_0x3db8f5;mouse.x=t[e(429)]/window[e(526)]*2-1,mouse.y=-t[e(511)]/window[e(504)]*2+1,raycaster[e(502)](mouse,camera);const o=new(_0x43581d[e(370)]);raycaster[e(435)].at(explosionDistance,o);const a=new _0x43581d.Group,s=makeMat({map:circleTexture,blending:_0x43581d[e(248)],depthWrite:!1,alphaSupport:!0,vertexColors:!0}),r=30+20*Math[e(465)](),n=[],i=[],d=[],l=[],c=(new(_0x43581d[e(400)]))[e(325)](Math.random(),.9,.7);for(let t=0;t<r;t++){n[e(471)](o.x,o.y,o.z);const t=c[e(518)]().offsetHSL(.2*Math[e(465)]()-.1,0,0);i.push(t.r,t.g,t.b),d[e(471)](.8*Math[e(465)]()+.2);const a=Math[e(465)]()*Math.PI*2,s=Math[e(360)](2*Math[e(465)]()-1),r=15*Math.random()+10,x=new(_0x43581d[e(370)]);x[e(517)](1,a,s),l[e(471)](x[e(297)](r))}const x=new(_0x43581d[e(542)]);x[e(492)]("position",new(_0x43581d[e(287)])(n,3)),x.setAttribute(e(314),new(_0x43581d[e(287)])(i,3)),x.setAttribute("size",new(_0x43581d[e(287)])(d,1));const _=new(_0x43581d[e(441)])(x,s);a[e(356)](_),a[e(261)][e(520)]=l,a[e(261)][e(264)]=1,scene[e(356)](a),explosionEffects[e(471)](a)}function setupEffectPools(){const t=_0x3db8f5,e=document[t(537)](t(495));e[t(263)]=256,e.height=256;const o=e.getContext("2d"),a=o[t(311)](128,128,0,128,128,128);a[t(459)](0,"rgba(255,255,255,1)"),a.addColorStop(.3,"rgba(255,255,255,0.5)"),a[t(459)](1,t(418)),o[t(307)]=a,o[t(328)](0,0,256,256);const s=new(_0x43581d[t(286)])(e);for(let e=0;e<POOL_SIZE;e++){const e=new(_0x43581d[t(262)])({map:s,blending:_0x43581d[t(248)],transparent:!0,depthWrite:!1}),o=new(_0x43581d[t(337)])(new _0x43581d.PlaneGeometry(20,20),e);o[t(243)]=!1,o[t(261)][t(401)]=!1,scene[t(356)](o),effectPool[t(541)][t(471)](o);const a=100,r=new(_0x43581d[t(542)]);r.setAttribute("position",new _0x43581d.BufferAttribute(new Float32Array(3*a),3)[t(367)](_0x43581d[t(369)]));const n=makeMat({map:circleTexture,blending:_0x43581d[t(248)],alphaSupport:!0,depthWrite:!1}),i=new _0x43581d.Points(r,n);i[t(243)]=!1,i[t(261)][t(401)]=!1,scene.add(i),effectPool[t(410)][t(471)](i)}const r=appData?.messages||[],n=(appData?.[t(442)]||[])[t(428)](" ").split(" ");[...new Set(n[t(475)]((t=>t.length>0)))].forEach((e=>{const o=t,a=createFlyingTextTexture(e),s=new(_0x43581d[o(491)])({map:a,transparent:!0,depthWrite:!1,blending:_0x43581d[o(248)]}),r=new(_0x43581d[o(319)])(s),n=a[o(528)].width/a[o(528)][o(469)];r.scale[o(254)](1.5*n,1.5,1),r.visible=!1,r[o(261)][o(401)]=!1,r[o(261)].text=e,streamHeart[o(356)](r),effectPool[o(293)][o(471)](r)})),r[t(468)]((e=>{const o=t,a=createFlyingTextTexture(e),s=new(_0x43581d[o(491)])({map:a,transparent:!0,depthWrite:!1,blending:_0x43581d.AdditiveBlending}),r=new _0x43581d.Sprite(s),n=a[o(528)].width/a[o(528)][o(469)];r.scale[o(254)](2*n,2,1),r[o(243)]=!1,r[o(261)][o(401)]=!1,streamHeart[o(356)](r),effectPool[o(293)][o(471)](r)}))}function releaseTextToPool(t){const e=_0x3db8f5;if(activeTexts.has(t)){const o=activeTexts[e(446)](t);o.visible=!1,o[e(261)].active=!1,activeTexts.delete(t)}}function createFlyingTextTexture(t){const e=_0x3db8f5,o=document.createElement(e(495));o[e(263)]=1024,o[e(469)]=128;const a=o.getContext("2d");a[e(366)]=e(482),a[e(450)]=e(341),a[e(282)]="middle",a[e(258)]=e(301),a.lineWidth=8,a.strokeText(t,o.width/2,o[e(469)]/2),a[e(307)]=e(365),a[e(437)](t,o.width/2,o[e(469)]/2);const s=new(_0x43581d[e(286)])(o);return s[e(510)]=_0x43581d[e(408)],s[e(386)]=_0x43581d.LinearFilter,s}const positions=[],sampleCount=7e3,xs=polyPts[_0x3db8f5(472)]((t=>t.x)),ys=polyPts.map((t=>t.y)),minX=Math[_0x3db8f5(358)](...xs),maxX=Math[_0x3db8f5(383)](...xs),minY=Math[_0x3db8f5(358)](...ys),maxY=Math[_0x3db8f5(383)](...ys),threshold=minY+(maxY-minY)/6;for(;positions[_0x3db8f5(484)]/3<sampleCount;){const t=Math[_0x3db8f5(465)]()*(maxX-minX)+minX,e=Math.random()*(maxY-minY)+minY;if(isPointInsidePolygon({x:t,y:e},polyPts)){let o=1/0;for(let a=0;a<polyPts[_0x3db8f5(484)];a++){const s=polyPts[a],r=polyPts[(a+1)%polyPts[_0x3db8f5(484)]],n=r.x-s.x,i=r.y-s.y,d=((t-s.x)*n+(e-s.y)*i)/(n*n+i*i),l=Math[_0x3db8f5(383)](0,Math[_0x3db8f5(358)](1,d)),c=t-(s.x+l*n),x=e-(s.y+l*i),_=c*c+x*x;_<o&&(o=_)}const a=1/(1+2*Math[_0x3db8f5(288)](o));if(Math[_0x3db8f5(465)]()<a){const o=3.6*(Math[_0x3db8f5(465)]()-.5);positions.push(t-5,e-7,o)}}}let minZ=1/0,maxZval=-1/0;for(let t=2;t<positions[_0x3db8f5(484)];t+=3){const e=positions[t];e<minZ&&(minZ=e),e>maxZval&&(maxZval=e)}const heartDepth=maxZval-minZ,heartWidth=maxX-minX,planeXVar=2*heartWidth,rStreamStart=.8*heartWidth,Rmax=rStreamStart,rVortex=.6*heartWidth,planeZVar=15*heartDepth,planeYCenter=maxY,planeYVar=1,riseDuration=10,fallDuration=0,holdDuration=0,STREAM_RISE_MIN=8,STREAM_RISE_MAX=12,INDENT_Y=maxY-.25*(maxY-minY),INDENT_HALF_WIDTH=.35*heartWidth,COS_ANGLE_THRESH=.707106,CLIP_FRONT_Z=.3,staticGeo=new(_0x43581d[_0x3db8f5(542)]),originalPositions=positions[_0x3db8f5(451)]();staticGeo.setAttribute(_0x3db8f5(480),new _0x43581d.Float32BufferAttribute(originalPositions,3));const colors=[];for(let t=0;t<positions.length;t+=3)colors.push(heartInitialColor.r,heartInitialColor.g,heartInitialColor.b);staticGeo[_0x3db8f5(492)]("color",new(_0x43581d[_0x3db8f5(287)])(colors,3));const staticSizes=new Float32Array(positions[_0x3db8f5(484)]/3),SIZE_SCALE=2;for(let t=0;t<staticSizes[_0x3db8f5(484)];t++)staticSizes[t]=2*(.3*Math[_0x3db8f5(465)]()+.2);staticGeo[_0x3db8f5(492)](_0x3db8f5(279),new _0x43581d.Float32BufferAttribute(staticSizes,1));const topIndices=[];for(let t=0;t<positions.length;t+=3)positions[t+1]>threshold+.1*(Math[_0x3db8f5(465)]()-.5)*(maxY-minY)&&topIndices[_0x3db8f5(471)](t/3);const topSet=new Set(topIndices);let bottomPositions=[];const bottomColors=[],bottomSizes=[],bottomSizesBase=[],topPositionsArr=[],topColors=[],topSizes=[],topAlpha=[],idxToTopIdx=new Int32Array(positions[_0x3db8f5(484)]/3)[_0x3db8f5(493)](-1);for(let t=0,e=0;t<positions[_0x3db8f5(484)];t+=3){const o=t/3,a=staticSizes[o],s=positions[t],r=positions[t+1],n=positions[t+2];if(topSet.has(o)){topPositionsArr[_0x3db8f5(471)](s,r,n),topColors[_0x3db8f5(471)](heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),topSizes[_0x3db8f5(471)](a);const t=Math[_0x3db8f5(267)](s)<INDENT_HALF_WIDTH&&r>INDENT_Y;topAlpha[_0x3db8f5(471)](t?0:1),idxToTopIdx[o]=e++}else bottomPositions[_0x3db8f5(471)](s,r,n),bottomColors[_0x3db8f5(471)](heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),bottomSizes[_0x3db8f5(471)](a)}staticGeo.setAttribute(_0x3db8f5(480),new(_0x43581d[_0x3db8f5(287)])(topPositionsArr,3)),staticGeo[_0x3db8f5(492)](_0x3db8f5(314),new(_0x43581d[_0x3db8f5(287)])(topColors,3)),staticGeo[_0x3db8f5(492)](_0x3db8f5(279),new(_0x43581d[_0x3db8f5(287)])(topSizes,1)),staticGeo[_0x3db8f5(492)](_0x3db8f5(448),new(_0x43581d[_0x3db8f5(338)])(new Float32Array(topAlpha),1)),staticGeo[_0x3db8f5(457)][_0x3db8f5(480)].needsUpdate=!0,staticGeo[_0x3db8f5(457)][_0x3db8f5(448)].needsUpdate=!0;const topCount=topPositionsArr[_0x3db8f5(484)]/3,topRadiusArr=new Float32Array(topCount),topPhaseArr=new Float32Array(topCount),topDelayArr=new Float32Array(topCount);for(let t=0;t<topCount;t++){const e=topPositionsArr[3*t],o=topPositionsArr[3*t+2],a=Math[_0x3db8f5(288)](e*e+o*o);topRadiusArr[t]=a,topPhaseArr[t]=Math[_0x3db8f5(385)](o,e),topDelayArr[t]=10*Math[_0x3db8f5(465)]()}const GLOBAL_SPIRAL_FREQ=.5,BASE_OMEGA=-1*Math.PI/10,GATHER_RATIO=.01,HOLD_RATIO=.2,radiusPow=2.5,rCore=.25,rOuter=rVortex,vIn=.9,SHRINK_TO_CORE=!1,BURST_SPREAD=.1,FADE_DURATION=1.5,SPAWN_DELAY_MAX=3,ASCEND_DELAY_MAX=10,apexY=maxY,LOW_REGION_FACTOR=.5;let minBottomY=1/0,maxBottomY=-1/0;for(let t=1;t<bottomPositions[_0x3db8f5(484)];t+=3){const e=bottomPositions[t];e<minBottomY&&(minBottomY=e),e>maxBottomY&&(maxBottomY=e)}const Y_THRESHOLD=minBottomY+.5*(maxBottomY-minBottomY),HIGH_BOTTOM_MULT=2;{const t=[],e=[],o=[];for(let a=0;a<bottomPositions.length;a+=3){const s=bottomPositions[a+1];if(s>=Y_THRESHOLD)for(let r=1;r<2;r++)t[_0x3db8f5(471)](bottomPositions[a],s,bottomPositions[a+2]),e[_0x3db8f5(471)](heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),o[_0x3db8f5(471)](bottomSizes[a/3])}bottomPositions[_0x3db8f5(471)](...t),bottomColors[_0x3db8f5(471)](...e),bottomSizes[_0x3db8f5(471)](...o)}const BOTTOM_ROTATE_RATIO=.2,rotPos=[],rotColors=[],rotSizes=[],staticBotPos=[],staticBotColors=[],staticBotSizes=[];for(let t=0;t<bottomPositions[_0x3db8f5(484)];t+=3)Math[_0x3db8f5(465)]()<.2?(rotPos.push(bottomPositions[t],bottomPositions[t+1],bottomPositions[t+2]),rotColors[_0x3db8f5(471)](heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),rotSizes.push(bottomSizes[t/3])):(staticBotPos.push(bottomPositions[t],bottomPositions[t+1],bottomPositions[t+2]),staticBotColors.push(heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),staticBotSizes[_0x3db8f5(471)](bottomSizes[t/3]));bottomPositions[_0x3db8f5(484)]=0,bottomPositions[_0x3db8f5(471)](...rotPos),bottomColors[_0x3db8f5(484)]=0,bottomColors[_0x3db8f5(471)](...rotColors),bottomSizes.length=0,bottomSizes[_0x3db8f5(471)](...rotSizes);const bottomCount=bottomPositions.length/3,bottomRadiusArr=new Float32Array(bottomCount),bottomPhaseArr=new Float32Array(bottomCount),bottomDelayArr=new Float32Array(bottomCount),CLEFT_FACTOR=2.5,bottomAlphaArr=new Float32Array(bottomCount)[_0x3db8f5(493)](1),bottomIsLow=new Uint8Array(bottomCount),pivotOffset=.25*heartWidth,KEEP_LOW_MIN=0,KEEP_LOW_MAX=.3;for(let t=0;t<bottomCount;t++){const e=bottomPositions[3*t],o=bottomPositions[3*t+1],a=bottomPositions[3*t+2],s=o<Y_THRESHOLD;if(bottomIsLow[t]=s?1:0,s){const e=0+(o-minBottomY)/(Y_THRESHOLD-minBottomY)*.3;bottomAlphaArr[t]=Math[_0x3db8f5(465)]()<e?1:0}else bottomAlphaArr[t]=1;const r=Math.sqrt(e*e+a*a),n=Math.atan2(a,e),i=Math.min(1,Math[_0x3db8f5(267)](e)/(.25*heartWidth)),d=1.5*Math[_0x3db8f5(323)](1-i,3)+1;bottomRadiusArr[t]=r*d,bottomPhaseArr[t]=n,bottomDelayArr[t]=10*Math[_0x3db8f5(465)]()}const bottomAlphaBase=Float32Array[_0x3db8f5(260)](bottomAlphaArr),bottomGeo=new(_0x43581d[_0x3db8f5(542)]);bottomGeo[_0x3db8f5(492)](_0x3db8f5(480),new(_0x43581d[_0x3db8f5(287)])(bottomPositions,3)),bottomGeo[_0x3db8f5(492)]("color",new(_0x43581d[_0x3db8f5(287)])(bottomColors,3)[_0x3db8f5(367)](_0x43581d[_0x3db8f5(369)])),bottomGeo[_0x3db8f5(492)](_0x3db8f5(279),new(_0x43581d[_0x3db8f5(287)])(bottomSizes,1)),bottomGeo[_0x3db8f5(492)](_0x3db8f5(448),new _0x43581d.BufferAttribute(bottomAlphaArr,1));const V_SLOPE=.3,matBottom=makeMat({map:circleTexture,alphaSupport:!0,vClipSlope:.3,clipFrontZ:.3});matBottom[_0x3db8f5(449)]=.5;const bottomHeart=new(_0x43581d[_0x3db8f5(441)])(bottomGeo,matBottom);bottomHeart[_0x3db8f5(255)].z=Math.PI,bottomHeart.renderOrder=0,scene[_0x3db8f5(356)](bottomHeart);const BOTTOM_OMEGA=BASE_OMEGA,topPointVisibility=new Array(topIndices[_0x3db8f5(484)])[_0x3db8f5(493)](!0);let hiddenTopCount=0;const matStatic=makeMat({map:circleTexture,alphaSupport:!0});matStatic.alphaTest=.5;const staticHeart=new(_0x43581d[_0x3db8f5(441)])(staticGeo,matStatic);staticHeart[_0x3db8f5(255)].z=Math.PI,staticHeart[_0x3db8f5(396)]=0,scene[_0x3db8f5(356)](staticHeart);const TOP_STATIC_RATIO=.5;{const t=[],e=[],o=[];for(let a=0;a<topPositionsArr[_0x3db8f5(484)];a+=3){const s=calculateMinimumDistanceToBorder(topPositionsArr[a]+5,topPositionsArr[a+1]+7)<BORDER_THRESHOLD||Math[_0x3db8f5(465)]()<.3;Math.random()<.5&&s&&(t[_0x3db8f5(471)](topPositionsArr[a],topPositionsArr[a+1],topPositionsArr[a+2]),e.push(heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),o[_0x3db8f5(471)](topSizes[Math[_0x3db8f5(294)](a/3)]))}if(t[_0x3db8f5(484)]){const a=new(_0x43581d[_0x3db8f5(542)]);a[_0x3db8f5(492)](_0x3db8f5(480),new _0x43581d.Float32BufferAttribute(t,3)),a[_0x3db8f5(492)](_0x3db8f5(314),new(_0x43581d[_0x3db8f5(287)])(e,3)[_0x3db8f5(367)](_0x43581d[_0x3db8f5(369)])),a[_0x3db8f5(492)](_0x3db8f5(279),new(_0x43581d[_0x3db8f5(287)])(o,1));const s=makeMat({map:circleTexture,alphaSupport:!0});s.alphaTest=.5,staticTopHeart=new(_0x43581d[_0x3db8f5(441)])(a,s),staticTopHeart.rotation.z=Math.PI,staticTopHeart[_0x3db8f5(396)]=0,scene[_0x3db8f5(356)](staticTopHeart)}}if(staticBotPos.length>0){const t=new(_0x43581d[_0x3db8f5(542)]);t[_0x3db8f5(492)](_0x3db8f5(480),new _0x43581d.Float32BufferAttribute(staticBotPos,3)),t[_0x3db8f5(492)](_0x3db8f5(314),new(_0x43581d[_0x3db8f5(287)])(staticBotColors,3)[_0x3db8f5(367)](_0x43581d[_0x3db8f5(369)])),t[_0x3db8f5(492)](_0x3db8f5(279),new _0x43581d.Float32BufferAttribute(staticBotSizes,1));const e=makeMat({map:circleTexture,alphaSupport:!0});e.alphaTest=.5,staticBottomHeart=new(_0x43581d[_0x3db8f5(441)])(t,e),staticBottomHeart[_0x3db8f5(255)].z=Math.PI,staticBottomHeart[_0x3db8f5(396)]=0,scene[_0x3db8f5(356)](staticBottomHeart)}const SPAWN_MULT=.2,rimIndices=[];for(const t of topIndices)calculateMinimumDistanceToBorder(positions[3*t],positions[3*t+1])<BORDER_THRESHOLD&&rimIndices.push(t);const streamSource=rimIndices[_0x3db8f5(484)]?rimIndices:topIndices,streamCount=Math.floor(.2*streamSource[_0x3db8f5(484)]),targetIdxArr=new Uint32Array(streamCount);for(let t=0;t<streamCount;t++)targetIdxArr[t]=streamSource[t%streamSource[_0x3db8f5(484)]];const planeIdxForStream=new Int32Array(streamCount)[_0x3db8f5(493)](-1),streamPositions=new Float32Array(3*streamCount),streamGeo=new(_0x43581d[_0x3db8f5(542)]),streamAlpha=new Float32Array(streamCount).fill(1);streamGeo.setAttribute(_0x3db8f5(448),new(_0x43581d[_0x3db8f5(338)])(streamAlpha,1)),streamGeo[_0x3db8f5(492)](_0x3db8f5(480),new(_0x43581d[_0x3db8f5(338)])(streamPositions,3)[_0x3db8f5(367)](_0x43581d.DynamicDrawUsage));const streamColors=new Float32Array(3*streamCount);for(let t=0;t<streamCount;t++)streamColors[3*t]=heartInitialColor.r,streamColors[3*t+1]=heartInitialColor.g,streamColors[3*t+2]=heartInitialColor.b;streamGeo[_0x3db8f5(492)]("color",new(_0x43581d[_0x3db8f5(338)])(streamColors,3));const streamSizes=new Float32Array(streamCount);for(let t=0;t<streamCount;t++)streamSizes[t]=2*(.3*Math[_0x3db8f5(465)]()+.2+.1)*1;const streamSizeBase=streamSizes[_0x3db8f5(451)](),BIG_RATIO=.1;for(let t=0;t<streamCount;t++)Math[_0x3db8f5(465)]()<.1&&(streamSizes[t]*=1.5,streamColors[3*t]=heartInitialColor.r,streamColors[3*t+1]=heartInitialColor.g,streamColors[3*t+2]=heartInitialColor.b);streamGeo[_0x3db8f5(492)](_0x3db8f5(279),new(_0x43581d[_0x3db8f5(338)])(streamSizes,1));const matStream=makeMat({map:circleTexture,alphaSupport:!0,clipBandWidth:INDENT_HALF_WIDTH,clipFrontZ:.3});matStream[_0x3db8f5(449)]=.5;const streamHeart=new(_0x43581d[_0x3db8f5(441)])(streamGeo,matStream);streamHeart[_0x3db8f5(255)].z=Math.PI,streamHeart.renderOrder=1,scene[_0x3db8f5(356)](streamHeart),streamHeart[_0x3db8f5(243)]=!1,fadeObjects.push(streamHeart),streamHeart[_0x3db8f5(261)].fadeStage=STAGE.STREAM;const PLANE_COUNT=Math[_0x3db8f5(294)](120*rVortex),planePositions=[],planeColors=[],planeSizes=[],planeAlphaArr=new Float32Array(PLANE_COUNT).fill(1);for(let t=0;t<PLANE_COUNT;t++){const t=Math[_0x3db8f5(465)]()*Math.PI*2,e=Math[_0x3db8f5(288)](Math[_0x3db8f5(465)]())*rVortex;planePositions[_0x3db8f5(471)](Math.cos(t)*e,planeYCenter-7.5,Math[_0x3db8f5(527)](t)*e),planeColors[_0x3db8f5(471)](heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),planeSizes[_0x3db8f5(471)](1*Math.random()+.25)}const planeGeo=new(_0x43581d[_0x3db8f5(542)]);planeGeo[_0x3db8f5(492)](_0x3db8f5(480),new _0x43581d.Float32BufferAttribute(planePositions,3)),planeGeo[_0x3db8f5(492)](_0x3db8f5(314),new(_0x43581d[_0x3db8f5(287)])(planeColors,3)),planeGeo[_0x3db8f5(492)](_0x3db8f5(279),new(_0x43581d[_0x3db8f5(287)])(planeSizes,1)),planeGeo[_0x3db8f5(492)]("alpha",new(_0x43581d[_0x3db8f5(338)])(planeAlphaArr,1));const matPlane=makeMat({map:circleTexture,alphaSupport:!0});matPlane.alphaTest=.5;const planeLayer=new _0x43581d.Points(planeGeo,matPlane);planeLayer[_0x3db8f5(255)].z=Math.PI,scene[_0x3db8f5(356)](planeLayer),fadeObjects[_0x3db8f5(471)](planeLayer),fadeObjects[_0x3db8f5(276)](planeLayer)&&fadeObjects[_0x3db8f5(512)](fadeObjects[_0x3db8f5(419)](planeLayer),1),planeLayer[_0x3db8f5(243)]=!0;const PLANE_COLOR_CYCLE=9,PLANE_COL_WHITE=new(_0x43581d[_0x3db8f5(400)])(_0x3db8f5(474)),PLANE_COL_LIGHT=new(_0x43581d[_0x3db8f5(400)])(_0x3db8f5(249)),PLANE_COL_DARK=new _0x43581d.Color(_0x3db8f5(284));function _0x44d4(t,e){const o=_0x9c0d();return(_0x44d4=function(t,e){return o[t-=239]})(t,e)}function createTextSpriteTexture(t){const e=_0x3db8f5,o=document[e(537)](e(495));o.width=o[e(469)]=128;const a=o[e(364)]("2d");a[e(307)]=e(425),a[e(328)](0,0,128,128),a[e(450)]=e(341),a[e(282)]=e(397),a[e(366)]='300 70.4px "Mali","Comfortaa","Segoe UI Emoji","Noto Color Emoji","Apple Color Emoji",sans-serif',a[e(490)]=7.68,a.strokeStyle=e(301),a[e(309)](t,64,64),a[e(307)]=e(365),a[e(437)](t,64,64);const s=new(_0x43581d[e(286)])(o);return s.minFilter=s.magFilter=_0x43581d[e(408)],s}planeGeo[_0x3db8f5(457)][_0x3db8f5(314)][_0x3db8f5(367)](_0x43581d[_0x3db8f5(369)]);const ringCharsFull=RingText[_0x3db8f5(428)](""),ringChars=Array[_0x3db8f5(260)](ringCharsFull),charMatMap={};function generateTextRingTexture(t){const e=_0x3db8f5,o=document[e(537)](e(495));o[e(263)]=2048,o[e(469)]=256;const a=o.getContext("2d");a[e(307)]=e(425),a[e(328)](0,0,o[e(263)],o[e(469)]),a[e(366)]=e(478),a.textAlign="center",a.textBaseline="middle";const s=o[e(469)]/t[e(484)];t[e(468)](((t,r)=>{const n=e,i=(r+.5)*s;a[n(381)]="#ff40c8",a.shadowBlur=0,a[n(307)]=n(308),a[n(437)](t,o.width/2,i),a[n(409)]=0,a[n(258)]="rgba(160, 30, 95, 0.9)",a[n(490)]=3,a[n(309)](t,o[n(263)]/2,i),a[n(307)]="#ffffff",a[n(437)](t,o[n(263)]/2,i)}));const r=new(_0x43581d[e(286)])(o);return r[e(497)]=!0,r}[...new Set(ringChars)].forEach((t=>{const e=_0x3db8f5;charMatMap[t]=new(_0x43581d[e(491)])({map:createTextSpriteTexture(t),transparent:!0,depthWrite:!1})}));const ringTexture=generateTextRingTexture(RingText),ringMat=new(_0x43581d[_0x3db8f5(262)])({map:ringTexture,transparent:!0,side:_0x43581d[_0x3db8f5(488)],depthWrite:!1,blending:_0x43581d[_0x3db8f5(248)]}),RING_THICKNESS=3.5,RING_HUE_SPEED=.05,RING_FADE_DIST=1,RING_FADE_SPEED=2,ringHeight=.8,RING_Y_OFFSET=2*-planeYCenter-.5,ringGeo=new(_0x43581d[_0x3db8f5(464)])(rVortex,rVortex,1,128,1,!0),RING_SPACING=2,RING_START_RADIUS=rVortex,RING_END_RADIUS=.25,RING_COUNT=Math[_0x3db8f5(416)]((RING_START_RADIUS-.25)/2),RING_FLIP_Y=Math.PI,ribbon=new(_0x43581d[_0x3db8f5(250)]);ribbon[_0x3db8f5(480)][_0x3db8f5(254)](0,planeYCenter+RING_Y_OFFSET,0),ribbon[_0x3db8f5(255)].z=Math.PI,scene[_0x3db8f5(356)](ribbon),ribbon[_0x3db8f5(243)]=!0;for(let t=0;t<RING_COUNT;t++){const e=generateTextRingTexture([RingText[t%RingText[_0x3db8f5(484)]]]);e.wrapS=_0x43581d[_0x3db8f5(456)],e[_0x3db8f5(470)][_0x3db8f5(254)](2,1),e[_0x3db8f5(420)].x=1;const o=new _0x43581d.MeshBasicMaterial({map:e,transparent:!0,side:_0x43581d[_0x3db8f5(488)],depthWrite:!1,blending:_0x43581d[_0x3db8f5(248)]}),a=new(_0x43581d[_0x3db8f5(337)])(ringGeo,o);a[_0x3db8f5(255)].x=Math.PI;const s=RING_START_RADIUS-2*t,r=2*(Math[_0x3db8f5(465)]()-.5)*.3;a[_0x3db8f5(261)][_0x3db8f5(315)]=s+r,a.userData.phase=Math[_0x3db8f5(465)]()*Math.PI*2;const n=s/RING_START_RADIUS;a[_0x3db8f5(407)].set(n,3.5,n),a[_0x3db8f5(240)][_0x3db8f5(317)]=1,a.material[_0x3db8f5(372)]=!0,a[_0x3db8f5(240)][_0x3db8f5(296)]=!1,a[_0x3db8f5(396)]=t,ribbon[_0x3db8f5(356)](a)}const vortexIndices=[];for(let t=0;t<positions[_0x3db8f5(484)]/3;t++)topIndices.includes(t)||vortexIndices[_0x3db8f5(471)](t);const vortexCount=vortexIndices[_0x3db8f5(484)],vortexPositions=new Float32Array(3*vortexCount),vortexPhase=new Float32Array(vortexCount),vortexRadius=new Float32Array(vortexCount);for(let t=0;t<vortexCount;t++){vortexPhase[t]=Math[_0x3db8f5(465)]()*Math.PI*2;const e=Math.random()*rVortex;vortexRadius[t]=e,vortexPositions[3*t]=Math[_0x3db8f5(342)](vortexPhase[t])*e,vortexPositions[3*t+1]=planeYCenter,vortexPositions[3*t+2]=Math[_0x3db8f5(527)](vortexPhase[t])*e}const vortexGeo=new _0x43581d.BufferGeometry;vortexGeo[_0x3db8f5(492)]("position",new(_0x43581d[_0x3db8f5(338)])(vortexPositions,3).setUsage(_0x43581d.DynamicDrawUsage));const vortexColors=new Float32Array(3*vortexCount);for(let t=0;t<vortexCount;t++)vortexColors[3*t]=heartInitialColor.r,vortexColors[3*t+1]=heartInitialColor.g,vortexColors[3*t+2]=heartInitialColor.b;vortexGeo[_0x3db8f5(492)](_0x3db8f5(314),new(_0x43581d[_0x3db8f5(338)])(vortexColors,3));const vortexSizes=new Float32Array(vortexCount);for(let t=0;t<vortexCount;t++)vortexSizes[t]=.2*Math[_0x3db8f5(465)]()+.15;function _0x9c0d(){const t=["uniforms","abs","Tự động phát bị chặn.","error","style","isActive","8dOnkKd","HEART","Image config:","vertexShader","includes","7313346eCQNZp","617607TvNYih","size","fixed","lookAt","textBaseline","autoClear","rgb(241, 121, 185)","delete","CanvasTexture","Float32BufferAttribute","sqrt","setSize","Không tìm thấy dữ liệu trong link. Sử dụng dữ liệu mặc định.","querySelector","minPolarAngle","texts","floor","measureText","depthWrite","multiplyScalar","setPixelRatio","then","render","rgba(160, 30, 95, 0.9)","AmbientLight","applyMatrix4","Scene","TextureLoader","crossVectors","fillStyle","#ff40c8","strokeText","getElapsedTime","createRadialGradient","MathUtils","music","color","radius","fragmentShader","opacity","copy","Sprite","#ff149300","replace","100vh","pow","contextmenu","setHSL","keydown","test","fillRect","children","touchend","#ff69b400","157052ZjsmrS","12284890AzkZtc","arc","spawnInterval","imageIndex","Mesh","BufferAttribute","preventDefault","degToRad","center","cos","warn","change","sub","particleIndex","sort","devicePixelRatio","closePath","516940dwxHCe","split","phase","#ff9090","aspectScale","maxWidth","add","Heartlove data đã được load:","min","width=device-width, initial-scale=1.0, user-scalable=no","acos","parent","attribute float size;","array","getContext","#ffffff","font","setUsage","resize","DynamicDrawUsage","Vector3","enablePan","transparent","void main() {","Heartlove","heartColor","traverse","#include <project_vertex>\n  vAlpha = alpha;","Dữ liệu không hợp lệ:","href","maxActiveImages","shadowColor",'\n                <h1 style="color:red; font-size: 28px; text-align: center; margin-top: 100px;"> 🚨 DevTools is open!</h1>\n                <h1 style="color:red; font-size: 24px; text-align: center;">Press F12 to close.</h1>',"max","overflow","atan2","magFilter","shiftKey","aHR0cHM6Ly9kZXZwYW4udmVyY2VsLmFwcA==","#include <project_vertex>","hypot","getTime","gl_FragColor = vec4( outgoingLight, diffuseColor.a );","PerspectiveCamera","beginPath","\x68\x74\x74\x70\x73\x3A\x2F\x2F\x67\x69\x74\x68\x75\x62\x2E\x63\x6F\x6D\x2F\x50\x61\x6E\x62\x61\x70\x2F\x61\x6E\x68\x2F\x62\x6C\x6F\x62\x2F\x6D\x61\x69\x6E\x2F\x65\x72\x72\x6F\x72\x2F\x6D\x79\x68\x65\x61\x72\x74\x76\x31\x61\x32\x2E\x70\x6E\x67\x3F\x72\x61\x77\x3D\x74\x72\x75\x65","renderOrder","middle","loop","none","Color","active",'"></i>',"domElement","log","gestureend","moveTo","scale","LinearFilter","shadowBlur","sparkles","remove","hostname","load","click",'<i class="fas fa-volume-high"></i>',"ceil","baseOpacity","rgba(255,255,255,0)","indexOf","offset","getDelta","setRGB","RGBAFormat"," Anh yêu em ","rgba(0,0,0,0)","Vector2","count","join","clientX","spawnTime","maxDistance","src","viewport","rgba(255,105,180,0.6)","ray","gl_FragColor = vec4( outgoingLight, diffuseColor.a * vAlpha );","fillText",'meta[name="viewport"]',"attribute float size; attribute float alpha; varying float vAlpha;","head","Points","messages","reload","name","gesturestart","get","Clock","alpha","alphaTest","textAlign","slice","STREAM","onload","fa-volume-high","trim","RepeatWrapping","attributes","format","addColorStop","data","getPoints","body","matrixWorldInverse","CylinderGeometry","random","matrixWorld","text","forEach","height","repeat","push","map","damp","rgb(255, 227, 249)","filter","pointerdown","100%",'bold 80px "Mali", sans-serif',"key","position","musicToggle",'bold 70px "Mali", sans-serif',"geometry","length","priority","2327500tJWiHd","onerror","DoubleSide","creationTime","lineWidth","SpriteMaterial","setAttribute","fill","catch","canvas","aspect","needsUpdate","752772Uzhash","addEventListener","has","auto","setFromCamera","U3lzdGVtIG1haW50ZW5hbmNlIGluIHByb2dyZXNz","innerHeight","images","clear","meta","hidden","innerHTML","minFilter","clientY","splice","play","userAgent","button","aHR0cHM6Ly9kZXZwYW4udmVyY2VsLmFwcC8=","setFromSphericalCoords","clone","removeEventListener","velocities","clamp","isSprite","PlaneGeometry","lerp","getAzimuthalAngle","innerWidth","sin","image","bezierCurveTo","maxPolarAngle","PointLight","display","enableDamping","content","15HpzAqi","index","createElement","Shape","onBeforeCompile","2atrcUd","waves","BufferGeometry","clearDepth","material","STAR","cGFuYmFwLmdpdGh1Yi5pbw==","visible","rgba(255,255,255,1)","appendChild","pop","fadeStage","AdditiveBlending","rgb(255,192,215)","Group","find","addPass","bold 48px Arial, sans-serif","set","rotation","varying float vAlpha;\nvoid main(){","parse","strokeStyle","gesturechange","from","userData","MeshBasicMaterial","width","life","uniform float size;"];return(_0x9c0d=function(){return t})()}vortexGeo[_0x3db8f5(492)](_0x3db8f5(279),new(_0x43581d[_0x3db8f5(338)])(vortexSizes,1));const vortexMat=makeMat({map:circleTexture,blending:_0x43581d.AdditiveBlending,opacity:.8});vortexMat[_0x3db8f5(539)]=function(t){const e=_0x3db8f5;t.vertexShader=t.vertexShader[e(321)](e(265),e(362))};const heartLayers=[staticHeart,bottomHeart,staticBottomHeart,staticTopHeart];heartLayers[_0x3db8f5(468)]((t=>{const e=_0x3db8f5;t&&(scene.remove(t),heartScene[e(356)](t))})),heartLayers.forEach((t=>{const e=_0x3db8f5;t&&(t[e(243)]=!1,t[e(261)][e(247)]=STAGE[e(273)],fadeObjects[e(276)](t)||fadeObjects[e(471)](t))}));const HEART_OFFSET_Y=10;[staticHeart,bottomHeart,staticTopHeart,staticBottomHeart][_0x3db8f5(468)]((t=>{t&&(t[_0x3db8f5(480)].y+=10)}));const HEART_OFFSET_YY=8;[streamHeart,ribbon][_0x3db8f5(468)]((t=>{t&&(t.position.y+=8)}));const ENABLE_EXPLOSION=!1;let expPositions,expVelocities,expBirth,expGeo,expColors,expMat,explosionPoints,MAX_EXP,expCount=0;const startTimes=new Float32Array(streamCount),STATE_ON_DISK=0,STATE_ASCEND=1,streamState=new Uint8Array(streamCount),curRadiusArr=new Float32Array(streamCount),ascendStart=new Float32Array(streamCount),spiralPhase=new Float32Array(streamCount),streamRadius=new Float32Array(streamCount),initialRadius=new Float32Array(streamCount),spiralFrequency=new Float32Array(streamCount),spiralDirection=new Float32Array(streamCount),extraRotArr=new Float32Array(streamCount),MAX_TOP_HIDE=Math[_0x3db8f5(294)](1*topIndices[_0x3db8f5(484)]),HIDE_DISTANCE=.25,TOP_ROT_SPEED=.5,streamRiseDuration=new Float32Array(streamCount),streamOffsets=new Float32Array(3*streamCount);for(let t=0;t<streamCount;t++){const e=3*t,o=Math[_0x3db8f5(465)]()*Math.PI*2,a=Math[_0x3db8f5(360)](2*Math[_0x3db8f5(465)]()-1),s=.4;streamOffsets[e]=s*Math.sin(a)*Math[_0x3db8f5(342)](o),streamOffsets[e+1]=s*Math[_0x3db8f5(527)](a)*Math.sin(o),streamOffsets[e+2]=s*Math.cos(a)}function initializeStreamParticleState(t,e){const o=_0x3db8f5,a=3*t,s=targetIdxArr[t];let r=-1;for(let t=0;t<100;t++){const t=Math[o(294)](Math[o(465)]()*PLANE_COUNT),e=planePositions[3*t],a=planePositions[3*t+2];if(Math.hypot(e,a)<=.26){r=t;break}}-1===r&&(r=Math[o(294)](Math[o(465)]()*PLANE_COUNT)),planeIdxForStream[t]=r;const n=Math[o(465)]()*Math.PI*2;planePositions[3*r]=Math[o(342)](n)*rOuter,planePositions[3*r+2]=Math[o(527)](n)*rOuter,planeGeo[o(457)][o(480)][o(497)]=!0;const i=planeLayer[o(255)].y,d=Math.cos(i),l=Math[o(527)](i),c=d*planePositions[3*r]-l*planePositions[3*r+2],x=l*planePositions[3*r]+d*planePositions[3*r+2];streamPositions[a]=c,streamPositions[a+1]=planePositions[3*r+1],streamPositions[a+2]=x;const _=.25+(rOuter-.25)*Math[o(465)](),m=Math[o(465)]()*Math.PI*2;streamPositions[a]=Math[o(342)](m)*_,streamPositions[a+1]=planeYCenter,streamPositions[a+2]=Math[o(527)](m)*_,curRadiusArr[t]=_,spiralPhase[t]=m,streamState[t]=STATE_ON_DISK,startTimes[t]=e-Math[o(465)]()*(rOuter-.25)/.9,ascendStart[t]=10*Math[o(465)](),streamRiseDuration[t]=8+4*Math[o(465)]();const f=.5+1.5*Math[o(465)](),b=Math[o(465)]()<.5?-1:1;extraRotArr[t]=2*f*Math.PI*b;const p=idxToTopIdx[s];-1!==p&&(topAlpha[p]=1,staticGeo[o(457)].alpha.needsUpdate=!0),activeImages.has(t)&&releaseImageToPool(t),activeTexts[o(500)](t)&&releaseTextToPool(t),streamAlpha[t]=1,streamGeo[o(457)].alpha[o(497)]=!0}const now0=0;for(let t=0;t<streamCount;t++)initializeStreamParticleState(t,0);streamGeo[_0x3db8f5(457)][_0x3db8f5(480)][_0x3db8f5(497)]=!0,streamGeo[_0x3db8f5(457)].alpha.needsUpdate=!0;const clock=new(_0x43581d[_0x3db8f5(447)]);let initialColorApplied=!1;function mainAnimationLoop(){const t=_0x3db8f5;requestAnimationFrame(mainAnimationLoop);let e=clock[t(421)]();const o=clock.getElapsedTime();e>.1&&(e=.1);for(let l=0;l<PLANE_COUNT;l++){const c=3*l;let x=planePositions[c],_=planePositions[c+2],m=Math[t(390)](x,_);if(m>.25){m=Math[t(383)](.25,m-.9*e);const f=Math[t(385)](_,x);planePositions[c]=Math.cos(f)*m,planePositions[c+2]=Math[t(527)](f)*m}}if(planeGeo[t(457)][t(480)][t(497)]=!0,planeLayer[t(243)]&&(planeLayer[t(243)]=!0),planeLayer.rotation.y=BASE_OMEGA*o,void 0!==ribbon&&(ribbon[t(255)].y=planeLayer[t(255)].y+RING_FLIP_Y),void 0!==ribbon&&ribbon[t(329)][t(484)]){const b=RING_START_RADIUS-.25;ribbon[t(329)].forEach(((o,a)=>{const s=t;o[s(261)].radius-=.9*e,o[s(261)][s(315)]-1.75<.25&&(o[s(261)][s(315)]+=b+2);const r=o.userData[s(315)]-1.75;if(r<1.25){const t=_0x43581d[s(312)][s(521)]((r-.25)/1,0,1);o.material[s(317)]=t}r<.25&&(o[s(261)].radius+=b+2,o.material[s(317)]=0),o[s(240)][s(317)]<1&&(o[s(240)].opacity=Math[s(358)](1,o.material.opacity+2*e));const n=o[s(261)][s(315)]/RING_START_RADIUS;o.scale.set(n,3.5,n),o[s(240)][s(314)][s(254)](16777215),o[s(255)].y=o[s(261)][s(352)]}))}camera.updateMatrixWorld();const a=camera[t(463)];if(cosmicDust[t(255)].y+=15e-5,streamHeartStarted){streamHeart[t(466)],new(_0x43581d[t(370)]),new(_0x43581d[t(370)]);const p=1e3*o;controlImageSpawningLogic(p),handleQueuedImageSpawns(),animateFloatingImageSprites(p),p-lastStatusLogTime>3e3&&(printImageSystemReport(),lastStatusLogTime=p);for(let h=0;h<streamCount;h++){const u=3*h,A=startTimes[h],I=o-(A+h%5*1.6),S=targetIdxArr[h];if(streamState[h]===STATE_ON_DISK){const g=spiralPhase[h]+BASE_OMEGA*(o-startTimes[h]);streamPositions[u]=Math.cos(g)*curRadiusArr[h],streamPositions[u+1]=planeYCenter,streamPositions[u+2]=Math.sin(g)*curRadiusArr[h],activeImages[t(500)](h)&&releaseImageToPool(h),streamAlpha[h]=1,I>=ascendStart[h]&&(streamState[h]=STATE_ASCEND,startTimes[h]=o,initialRadius[h]=curRadiusArr[h]);continue}if(I<-1.5){const P=spiralPhase[h]+BASE_OMEGA*(o-A);streamPositions[u]=initialRadius[h]*Math[t(342)](P),streamPositions[u+1]=planeYCenter,streamPositions[u+2]=initialRadius[h]*Math[t(527)](P),streamAlpha[h]=0;continue}if(I<0){const C=(I+1.5)/1.5,w=C*C*(3-2*C);streamAlpha[h]=w,activeImages[t(500)](h)&&releaseImageToPool(h);const E=spiralPhase[h]+BASE_OMEGA*(o-A);streamPositions[u]=initialRadius[h]*Math.cos(E),streamPositions[u+1]=planeYCenter,streamPositions[u+2]=initialRadius[h]*Math.sin(E);continue}const T=streamRiseDuration[h];if(I>=T){const y=(I-T)/1.5;if(y<1){const O=y*y*(3-2*y);if(streamAlpha[h]=1-O,activeImages.has(h)){const R=activeImages.get(h);imagePool[R].material.opacity*=1-O}const G=spiralPhase[h]+BASE_OMEGA*(o-A);streamPositions[u]=initialRadius[h]*Math[t(342)](G),streamPositions[u+1]=planeYCenter,streamPositions[u+2]=initialRadius[h]*Math[t(527)](G);continue}streamAlpha[h]=1,activeImages[t(500)](h)&&releaseImageToPool(h),initializeStreamParticleState(h,o),firstResetCompleted||(firstResetCompleted=!0);continue}streamAlpha[h]=1;const M=I/T;if(M<.01){let v,H,N;const D=spiralPhase[h]+BASE_OMEGA*(o-A);{const F=initialRadius[h];v=Math.cos(D)*F,N=Math[t(527)](D)*F;const L=Math.min(1,M/.01);H=_0x43581d[t(312)][t(524)](planeYCenter,apexY,L)}streamPositions[u]=v,streamPositions[u+1]=H,streamPositions[u+2]=N}else{const B=(M-.01)/.99,z=1-Math.pow(1-B,3),U=spiralPhase[h]+BASE_OMEGA*(o-A),Y=initialRadius[h],W=Math[t(342)](U)*Y,k=Math[t(527)](U)*Y,j=apexY,V=3*S,X=positions[V],Z=positions[V+1]-4+2,K=positions[V+2];let Q=_0x43581d[t(312)][t(524)](W,X,z),q=_0x43581d[t(312)][t(524)](j,Z,z),J=_0x43581d[t(312)][t(524)](k,K,z);const $=1+.1*(1-z);Q*=$,J*=$;const tt=(1-z)*extraRotArr[h],et=Math[t(342)](tt),ot=Math.sin(tt),at=Q*et-J*ot,st=Q*ot+J*et;streamPositions[u]=at,streamPositions[u+1]=q,streamPositions[u+2]=st}if(M<.01)streamAlpha[h]=1,activeImages[t(500)](h)&&releaseImageToPool(h);else{const rt=(M-.01)/.99;let nt=null;if(activeImages[t(500)](h)){const it=activeImages[t(446)](h);nt=imagePool[it]}if(nt){streamAlpha[h]=0,nt.visible=!0;const dt=1-Math[t(323)](1-rt,3),lt=3*S,ct=positions[lt],xt=positions[lt+1]-4+2,_t=positions[lt+2],mt=1+h%5*.2,ft=h%2==0?1:-1,bt=spiralPhase[h]+dt*mt*Math.PI*2*ft,pt=(1-dt)*(2+1*Math[t(527)](h)),ht=_0x43581d.MathUtils[t(524)](0,ct,dt),ut=_0x43581d[t(312)][t(524)](apexY,xt,dt),At=_0x43581d.MathUtils[t(524)](0,_t,dt),It=ht+Math[t(342)](bt)*pt,St=ut,Tt=At+Math.sin(bt)*pt;if(nt[t(480)][t(254)](It,St,Tt),dt>.4){const Mt=(dt-.4)/.6,gt=1;nt.material[t(317)]=gt*(1-Mt);const Pt=1-.9*Mt,Ct=nt[t(261)].aspectScale||{x:IMAGE_CONFIG[t(407)],y:IMAGE_CONFIG[t(407)]};nt[t(407)].set(Ct.x*Pt,Ct.y*Pt,1),Mt>.9&&(nt[t(243)]=!1,releaseImageToPool(h))}else{nt[t(240)][t(317)]=1;const wt=nt[t(261)][t(354)]||{x:IMAGE_CONFIG[t(407)],y:IMAGE_CONFIG[t(407)]};nt[t(407)][t(254)](wt.x,wt.y,1)}}else streamAlpha[h]=1}if(streamGeo.attributes.size[t(497)]=!0,M>.95){const Et=topIndices.indexOf(S);if(topPointVisibility[Et]&&hiddenTopCount<MAX_TOP_HIDE){topPointVisibility[Et]=!1;const yt=idxToTopIdx[S];-1!==yt&&(topAlpha[yt]=0,staticGeo[t(457)][t(448)][t(497)]=!0),hiddenTopCount++}}}}else{for(let Ot=0;Ot<streamCount;Ot++){if(streamHeartActiveRatio<1&&Ot/streamCount>.1){const vt=3*Ot,Ht=spiralPhase[Ot]+BASE_OMEGA*o;streamPositions[vt]=Math[t(342)](Ht)*curRadiusArr[Ot],streamPositions[vt+1]=planeYCenter,streamPositions[vt+2]=Math[t(527)](Ht)*curRadiusArr[Ot],streamAlpha[Ot]=0;continue}if(!firstResetCompleted&&Ot/streamCount>1e-4){const Nt=3*Ot,Dt=spiralPhase[Ot]+BASE_OMEGA*o;streamPositions[Nt]=Math[t(342)](Dt)*curRadiusArr[Ot],streamPositions[Nt+1]=planeYCenter,streamPositions[Nt+2]=Math[t(527)](Dt)*curRadiusArr[Ot],streamAlpha[Ot]=0;continue}const Gt=3*Ot,Rt=spiralPhase[Ot]+BASE_OMEGA*o;streamPositions[Gt]=Math[t(342)](Rt)*curRadiusArr[Ot],streamPositions[Gt+1]=planeYCenter,streamPositions[Gt+2]=Math[t(527)](Rt)*curRadiusArr[Ot],streamAlpha[Ot]=0}streamGeo[t(457)][t(480)][t(497)]=!0,streamGeo[t(457)][t(448)][t(497)]=!0}streamGeo[t(457)].position[t(497)]=!0,streamGeo[t(457)][t(448)][t(497)]=!0;for(let Ft=0;Ft<vortexCount;Ft++){const Lt=3*Ft,Bt=1*Math.PI/10,zt=vortexRadius[Ft],Ut=o*Bt,Yt=.3*Math[t(527)](Ut+vortexPhase[Ft]),Wt=.2*Math.cos(.7*Ut+vortexPhase[Ft]),kt=Ut+vortexPhase[Ft]+Yt,jt=zt*(1+Wt);vortexPositions[Lt]=Math[t(342)](kt)*jt,vortexPositions[Lt+1]=planeYCenter+.5*Math[t(527)](Ut+vortexPhase[Ft]),vortexPositions[Lt+2]=Math[t(527)](kt)*jt}vortexGeo[t(457)][t(480)][t(497)]=!0;const s=bottomGeo[t(457)].position[t(363)];for(let Vt=0;Vt<bottomCount;Vt++){if(o<bottomDelayArr[Vt])continue;const Xt=bottomPhaseArr[Vt],Zt=bottomRadiusArr[Vt],Kt=Math[t(342)](Xt)*Zt;if(Math.abs(Xt)<.25*Math.PI){const te=Math.min(1,Math[t(267)](Kt)/(.25*heartWidth)),ee=1.5*Math[t(323)](1-te,3)+1,oe=Kt>=0?1:-1;s[3*Vt]=Kt+oe*(Math.abs(Kt)*(ee-1))}else s[3*Vt]=Kt;s[3*Vt+2]=Math[t(527)](Xt)*Zt;const Qt=s[3*Vt],qt=s[3*Vt+1],Jt=s[3*Vt+2],$t=new(_0x43581d[t(370)])(Qt,qt,Jt)[t(303)](bottomHeart[t(466)]);(new(_0x43581d[t(370)]))[t(318)]($t)[t(303)](a),bottomAlphaArr[Vt]=bottomAlphaBase[Vt]}bottomGeo[t(457)].position[t(497)]=!0,bottomGeo[t(457)][t(448)][t(497)]=!0;const r=controls[t(525)]();if(staticHeart&&(staticHeart[t(255)].y=r),bottomHeart&&(bottomHeart[t(255)].y=r),staticBottomHeart&&(staticBottomHeart[t(255)].y=r),staticTopHeart&&(staticTopHeart[t(255)].y=r),heartbeatEnabled){const ae=1+.05*Math[t(527)](.5*o*Math.PI*2);staticHeart&&staticHeart.scale.set(ae,ae,ae),bottomHeart&&bottomHeart.scale[t(254)](ae,ae,ae),staticBottomHeart&&staticBottomHeart[t(407)].set(ae,ae,ae),staticTopHeart&&staticTopHeart.scale[t(254)](ae,ae,ae)}if(controls.update(),renderer.clear(),composerHeart[t(300)](),renderer[t(239)](),renderer[t(283)]=!1,composerMain[t(300)](),renderer[t(283)]=!0,hiddenTopCount<MAX_TOP_HIDE){for(let se=0;se<5&&hiddenTopCount<MAX_TOP_HIDE;se++){const re=Math[t(294)](Math[t(465)]()*topIndices[t(484)]),ne=topIndices[re];if(topPointVisibility[re]){topPointVisibility[re]=!1;const ie=idxToTopIdx[ne];-1!==ie&&(topAlpha[ie]=0,hiddenTopCount++)}}staticGeo[t(457)][t(480)][t(497)]=!0,staticGeo[t(457)][t(448)][t(497)]=!0}for(let de=explosionEffects[t(484)]-1;de>=0;de--){const le=explosionEffects[de];if(le[t(261)][t(264)]-=e,le[t(261)].life<=0)isPulsing||(isPulsing=!0,pulseStartTime=o,triggerCosmicRipple()),scene[t(411)](le),explosionEffects[t(512)](de,1);else{const ce=le.children[0],xe=ce[t(483)].attributes[t(480)][t(363)],_e=le[t(261)][t(520)],me=.04;for(let fe=0;fe<_e[t(484)];fe++){const be=3*fe,pe=new(_0x43581d[t(370)])(xe[be],xe[be+1],xe[be+2]),he=_e[fe],ue=HEART_CENTER_TARGET.clone()[t(345)](pe);he[t(524)](ue,me),xe[be]+=he.x*e,xe[be+1]+=he.y*e,xe[be+2]+=he.z*e}ce[t(483)][t(457)][t(480)][t(497)]=!0,le[t(261)][t(264)]<1&&(ce.material[t(317)]=le[t(261)].life/1)}}if(effectPool[t(541)][t(468)]((e=>{const a=t;if(!e[a(261)][a(401)])return;const s=(o-e[a(261)].creationTime)/1.8;s>=1?(e[a(261)].active=!1,e[a(243)]=!1):(e[a(281)](camera.position),e[a(407)].set(1+6*s,1+6*s,1),e[a(240)][a(317)]=.6*(1-s))})),effectPool[t(410)].forEach((a=>{const s=t;if(!a[s(261)].active)return;const r=(o-a[s(261)].creationTime)/1.8;if(r>=1)a[s(261)][s(401)]=!1,a[s(243)]=!1;else{const t=a[s(483)][s(457)][s(480)][s(363)],o=a.userData[s(520)];for(let a=0;a<100;a++){const s=3*a;t[s]+=o[s]*e,t[s+1]+=o[s+1]*e}a[s(483)].attributes[s(480)].needsUpdate=!0,a[s(240)][s(317)]=1-Math.pow(r,2)}})),streamHeartStarted&&allWordsFlat[t(484)]>0&&o>nextWordSpawnTime){const Ae=allWordsFlat[currentWordIndex];let Ie=-1;for(let Se=0;Se<streamCount;Se++){const Te=(o-startTimes[Se])/streamRiseDuration[Se];if(streamState[Se]===STATE_ASCEND&&Te>0&&Te<.1&&!activeImages.has(Se)&&!activeTexts.has(Se)){Ie=Se;break}}if(-1!==Ie){const Me=effectPool[t(293)][t(251)]((e=>!e[t(261)][t(401)]&&e[t(261)][t(467)]===Ae));Me&&(Me.userData[t(401)]=!0,Me.userData[t(430)]=o,Me[t(243)]=!0,Me[t(240)][t(317)]=0,activeTexts[t(254)](Ie,Me),currentWordIndex=(currentWordIndex+1)%allWordsFlat[t(484)],nextWordSpawnTime=o+WORD_SPAWN_INTERVAL)}}activeTexts[t(468)](((e,a)=>{const s=t,r=streamPositions[3*a],n=streamPositions[3*a+1],i=streamPositions[3*a+2];e[s(480)][s(254)](r,n+1.5,i);const d=o-e[s(261)][s(430)],l=(o-startTimes[a])/streamRiseDuration[a];e[s(240)][s(317)]=d<.8?d/.8:l>.7?Math[s(383)](0,1-(l-.7)/.3):1,(streamState[a]===STATE_ON_DISK||l>=1)&&releaseTextToPool(a)})),activeTexts[t(468)](((e,a)=>{const s=t,r=streamPositions[3*a],n=streamPositions[3*a+1],i=streamPositions[3*a+2];e[s(480)][s(254)](r,n+1.5,i);const d=o-e[s(261)][s(430)],l=(o-startTimes[a])/streamRiseDuration[a];e[s(240)][s(317)]=d<1?d/1:l>.7?Math.max(0,1-(l-.7)/.3):1,streamState[a]===STATE_ON_DISK&&releaseTextToPool(a)}));const n=[staticHeart,bottomHeart,staticBottomHeart,staticTopHeart];let i=new(_0x43581d[t(400)]);if(useCustomColor?i.copy(heartInitialColor):i[t(325)](.05*o%1,.8,.6),isPulsing){const ge=Math[t(358)]((o-pulseStartTime)/PULSE_DURATION,1),Pe=Math[t(527)](ge*Math.PI),Ce=1+PULSE_AMPLITUDE*Pe;n[t(468)]((e=>{const o=t;e&&e[o(407)][o(254)](Ce,Ce,Ce)}));const we=new _0x43581d.Color(16777215);i[t(524)](we,.8*Pe),ge>=1&&(isPulsing=!1,n[t(468)]((e=>{const o=t;e&&e[o(407)][o(254)](1,1,1)})))}if(!useCustomColor||isPulsing||!initialColorApplied){const Ee=i.r,ye=i.g,Oe=i.b;function d(e){const o=t;if(e)for(let t=0;t<e[o(484)];t+=3)e[t]=Ee,e[t+1]=ye,e[t+2]=Oe}d(planeGeo[t(457)][t(314)][t(363)]),d(staticGeo[t(457)][t(314)][t(363)]),d(bottomGeo[t(457)][t(314)].array),staticBottomHeart&&d(staticBottomHeart[t(483)][t(457)][t(314)].array),staticTopHeart&&d(staticTopHeart.geometry[t(457)][t(314)][t(363)]),d(vortexGeo[t(457)][t(314)][t(363)]),d(streamGeo.attributes[t(314)][t(363)]),planeGeo[t(457)][t(314)].needsUpdate=!0,staticGeo[t(457)].color[t(497)]=!0,bottomGeo.attributes[t(314)][t(497)]=!0,staticBottomHeart&&(staticBottomHeart[t(483)][t(457)][t(314)][t(497)]=!0),staticTopHeart&&(staticTopHeart[t(483)][t(457)][t(314)].needsUpdate=!0),vortexGeo[t(457)][t(314)].needsUpdate=!0,streamGeo[t(457)].color[t(497)]=!0,ribbon.children.forEach((e=>{const o=t;e[o(240)].color[o(422)](Ee,ye,Oe)})),initialColorApplied=!0}if(o>=nextShootTime){for(let Ge=0;Ge<SHOOT_MAX;Ge++)if(shootLife[Ge]<=0){const Re=3*Ge,ve=200,He=new _0x43581d.Vector3(2*(Math[t(465)]()-.5),2*(Math[t(465)]()-.5),2*(Math[t(465)]()-.5)).normalize().multiplyScalar(ve);shootPositions[Re]=He.x,shootPositions[Re+1]=He.y,shootPositions[Re+2]=He.z;const Ne=new(_0x43581d[t(370)])(Math[t(465)]()-.5,Math[t(465)]()-.5,Math[t(465)]()-.5).normalize(),De=(new(_0x43581d[t(370)]))[t(306)](He,Ne).normalize(),Fe=40+30*Math[t(465)]();shootVel[Re]=De.x*Fe,shootVel[Re+1]=De.y*Fe,shootVel[Re+2]=De.z*Fe,shootBirth[Ge]=o,shootLife[Ge]=(SHOOT_OUT_RADIUS-ve)/Fe,shootAlpha[Ge]=.8+.2*Math[t(465)]();break}nextShootTime=o+.5+Math.random()}for(let Le=0;Le<SHOOT_MAX;Le++)if(shootLife[Le]>0){const Be=3*Le;shootPositions[Be]+=shootVel[Be]*e,shootPositions[Be+1]+=shootVel[Be+1]*e,shootPositions[Be+2]+=shootVel[Be+2]*e;const ze=Math.hypot(shootPositions[Be],shootPositions[Be+1],shootPositions[Be+2]);if(shootBirth[Le],shootLife[Le],ze>SHOOT_OUT_RADIUS)shootLife[Le]=0,shootAlpha[Le]=0;else{const We=.9,ke=ze/SHOOT_OUT_RADIUS;shootAlpha[Le]=ke>We?1-(ke-We)/(1-We):1}const Ue=Le*(TAIL_SEGMENTS+1),Ye=3*Ue;tailPositions[Ye]=shootPositions[Be],tailPositions[Ye+1]=shootPositions[Be+1],tailPositions[Ye+2]=shootPositions[Be+2],tailAlphas[Ue]=shootAlpha[Le];for(let je=1;je<=TAIL_SEGMENTS;je++){const Ve=Le*(TAIL_SEGMENTS+1)+je,Xe=3*Ve;tailPositions[Xe]=shootPositions[Be]-shootVel[Be]*je*TAIL_SPACING,tailPositions[Xe+1]=shootPositions[Be+1]-shootVel[Be+1]*je*TAIL_SPACING,tailPositions[Xe+2]=shootPositions[Be+2]-shootVel[Be+2]*je*TAIL_SPACING;const Ze=1-je/TAIL_SEGMENTS;tailAlphas[Ve]=shootAlpha[Le]*Ze}}if(tailGeo[t(457)][t(480)][t(497)]=!0,tailGeo[t(457)][t(448)][t(497)]=!0,heartbeatEnabled){const Ke=1+.05*Math.sin(.5*o*Math.PI*2);staticHeart&&staticHeart[t(407)][t(254)](Ke,Ke,Ke),bottomHeart&&bottomHeart[t(407)][t(254)](Ke,Ke,Ke),staticBottomHeart&&staticBottomHeart[t(407)][t(254)](Ke,Ke,Ke),staticTopHeart&&staticTopHeart[t(407)][t(254)](Ke,Ke,Ke)}if(null!==revealStart&&(fadeObjects[t(468)]((e=>{const a=t;if(!e||e===ribbon)return;const s=e[a(261)].fadeStage??0,r=_0x43581d[a(312)].clamp((o-revealStart-STAGE_DURATION*s)/STAGE_DURATION,0,1),n=r*r*(3-2*r);e[a(376)]?.((t=>{const e=a,o=t.material;if(!o)return;if(t[e(522)]&&t[e(261)][e(467)]&&!1===t[e(261)][e(401)])return void(o[e(317)]=0);const s=t[e(261)][e(417)]??1;o[e(317)]=s*n})),s===STAGE[a(452)]&&n>.1&&(streamHeartStarted=!0,streamHeartActiveRatio=n)})),o-revealStart>STAGE_DURATION*(STAGE.HEART+1)&&(revealStart=null)),null!==cameraAnimationStart){const Qe=o-cameraAnimationStart,qe=_0x43581d[t(312)][t(521)](Qe/CAMERA_ANIMATION_DURATION,0,1),Je=qe*qe*(3-2*qe);camera[t(480)].x=_0x43581d[t(312)].lerp(CAMERA_START_POSITION.x,CAMERA_END_POSITION.x,Je),camera[t(480)].y=_0x43581d[t(312)].lerp(CAMERA_START_POSITION.y,CAMERA_END_POSITION.y,Je),camera[t(480)].z=_0x43581d.MathUtils.lerp(CAMERA_START_POSITION.z,CAMERA_END_POSITION.z,Je),camera[t(281)](0,0,0),qe>=1&&(cameraAnimationStart=null,camera[t(480)][t(254)](CAMERA_END_POSITION.x,CAMERA_END_POSITION.y,CAMERA_END_POSITION.z),camera.lookAt(0,0,0))}}function triggerCosmicRipple(){const t=_0x3db8f5,e=(new(_0x43581d[t(400)]))[t(325)](.05*clock.getElapsedTime()%1,.9,.7),o=effectPool.waves[t(251)]((e=>!e.userData[t(401)]));o&&(o[t(261)][t(401)]=!0,o[t(243)]=!0,o.userData[t(489)]=clock[t(310)](),o[t(480)][t(318)](HEART_CENTER_TARGET),o[t(255)].z=Math.PI,o[t(407)].set(1,1,1),o[t(240)][t(314)][t(318)](e));const a=effectPool[t(410)][t(251)]((t=>!t.userData.active));if(a){a.userData[t(401)]=!0,a[t(243)]=!0,a.userData[t(489)]=clock[t(310)](),a[t(480)][t(318)](HEART_CENTER_TARGET),a[t(255)].z=Math.PI,a.material[t(314)][t(318)](e);const o=a[t(483)][t(457)][t(480)][t(363)];for(let e=0;e<100;e++){const s=Math.random()*Math.PI*2,r=9,n=20*Math[t(465)]()+20,i=3*e;o[i]=Math[t(342)](s)*r,o[i+1]=Math[t(527)](s)*r,o[i+2]=5*(Math[t(465)]()-.5),a.userData[t(520)]||(a.userData[t(520)]=[]),a.userData.velocities[i]=Math[t(342)](s)*n,a[t(261)].velocities[i+1]=Math[t(527)](s)*n,a[t(261)][t(520)][i+2]=5*(Math[t(465)]()-.5)}a.geometry[t(457)][t(480)][t(497)]=!0}}setupEffectPools(),window.addEventListener(_0x3db8f5(368),(()=>{const t=_0x3db8f5;camera[t(496)]=window[t(526)]/window[t(504)],camera.updateProjectionMatrix(),renderer[t(289)](window[t(526)],window.innerHeight)}));const refinedBottomPos=[],refinedBottomColors=[],refinedBottomSizes=[];for(let t=0;t<bottomPositions[_0x3db8f5(484)];t+=3){const e=bottomPositions[t],o=bottomPositions[t+1],a=bottomPositions[t+2];(calculateMinimumDistanceToBorder(e,o)<BORDER_THRESHOLD||Math[_0x3db8f5(465)]()<.9)&&(refinedBottomPos[_0x3db8f5(471)](e,o,a),refinedBottomColors[_0x3db8f5(471)](heartInitialColor.r,heartInitialColor.g,heartInitialColor.b),refinedBottomSizes[_0x3db8f5(471)](bottomSizes[t/3]))}bottomPositions=refinedBottomPos,bottomColors[_0x3db8f5(484)]=0,bottomColors[_0x3db8f5(471)](...refinedBottomColors),bottomSizes[_0x3db8f5(484)]=0,bottomSizes[_0x3db8f5(471)](...refinedBottomSizes);const starLayers=[];function createStarLayer({count:t,radius:e,colors:o,minSize:a,maxSize:s,opacity:r=1.2}){const n=_0x3db8f5,i=new Float32Array(3*t),d=new Float32Array(3*t),l=new Float32Array(t),c=new Float32Array(t),x=new Float32Array(t),_=new Float32Array(t);for(let r=0;r<t;r++){const t=3*r,m=Math.acos(2*Math[n(465)]()-1),f=Math.random()*Math.PI*2;i[t]=e*Math.cos(f)*Math[n(527)](m),i[t+1]=e*Math[n(527)](f)*Math[n(527)](m),i[t+2]=e*Math[n(342)](m);const b=o[Math[n(294)](Math[n(465)]()*o.length)];d[t]=b.r,d[t+1]=b.g,d[t+2]=b.b,l[r]=Math[n(465)]()*(s-a)+a,c[r]=1,x[r]=Math[n(465)]()*Math.PI*2,_[r]=.5+1.5*Math[n(465)]()}const m=new _0x43581d.BufferGeometry;m.setAttribute(n(480),new(_0x43581d[n(338)])(i,3)),m[n(492)](n(314),new(_0x43581d[n(338)])(d,3)),m[n(492)](n(279),new(_0x43581d[n(338)])(l,1)),m[n(492)](n(448),new _0x43581d.BufferAttribute(c,1)[n(367)](_0x43581d[n(369)])),m[n(261)].phase=x,m.userData.twinkleSpeed=_;const f=makeMat({map:circleTexture,blending:_0x43581d[n(248)],depthWrite:!1,alphaSupport:!0,opacity:r,sizeAttenuation:!1,vertexColors:!0});return f[n(539)]=function(t){const e=n;t[e(275)]=t[e(275)][e(321)](e(265),e(439)),t.vertexShader=t[e(275)].replace(e(389),"#include <project_vertex>\n  vAlpha = alpha;"),t[e(316)]=t.fragmentShader[e(321)](e(373),e(256)),t[e(316)]=t[e(316)][e(321)](e(392),"gl_FragColor = vec4( outgoingLight, diffuseColor.a * vAlpha );")},new _0x43581d.Points(m,f)}const starColors=[new(_0x43581d[_0x3db8f5(400)])(16777215),new _0x43581d.Color(11197695),new(_0x43581d[_0x3db8f5(400)])(16777184),new(_0x43581d[_0x3db8f5(400)])(16767153)],farStars=createStarLayer({count:6e3,radius:250,colors:[new(_0x43581d[_0x3db8f5(400)])(11197695),new(_0x43581d[_0x3db8f5(400)])(16777215)],minSize:.5,maxSize:1.5,opacity:.8}),midStars=createStarLayer({count:3e3,radius:180,colors:starColors,minSize:1,maxSize:2.5,opacity:1}),nearStars=createStarLayer({count:1e3,radius:120,colors:starColors,minSize:1.5,maxSize:4,opacity:1.2});starLayers[_0x3db8f5(471)](farStars,midStars,nearStars),starLayers[_0x3db8f5(468)]((t=>{const e=_0x3db8f5;scene[e(356)](t),t.visible=!1,fadeObjects[e(471)](t),t[e(261)][e(247)]=STAGE[e(241)]}));const dustParticlesCount=50,dustPositions=new Float32Array(3*dustParticlesCount),dustColors=new Float32Array(3*dustParticlesCount),dustColor=new(_0x43581d[_0x3db8f5(400)])(16777215);for(let t=0;t<dustParticlesCount;t++){const e=3*t,o=Math[_0x3db8f5(360)](2*Math[_0x3db8f5(465)]()-1),a=Math[_0x3db8f5(465)]()*Math.PI*2,s=200*Math[_0x3db8f5(465)]()+50;dustPositions[e]=s*Math[_0x3db8f5(342)](a)*Math[_0x3db8f5(527)](o),dustPositions[e+1]=s*Math[_0x3db8f5(527)](a)*Math[_0x3db8f5(527)](o),dustPositions[e+2]=s*Math[_0x3db8f5(342)](o);const r=.5*Math[_0x3db8f5(465)]()+.5;dustColors[e]=dustColor.r*r,dustColors[e+1]=dustColor.g*r,dustColors[e+2]=dustColor.b*r}const dustGeometry=new(_0x43581d[_0x3db8f5(542)]);dustGeometry[_0x3db8f5(492)](_0x3db8f5(480),new(_0x43581d[_0x3db8f5(338)])(dustPositions,3)),dustGeometry[_0x3db8f5(492)](_0x3db8f5(314),new(_0x43581d[_0x3db8f5(338)])(dustColors,3));const dustMaterial=new _0x43581d.PointsMaterial({size:.2,vertexColors:!0,blending:_0x43581d[_0x3db8f5(248)],transparent:!0,opacity:.7}),cosmicDust=new(_0x43581d[_0x3db8f5(441)])(dustGeometry,dustMaterial);scene[_0x3db8f5(356)](cosmicDust),STAR_COUNT=0,starAlpha=null,starPhase=null,starGeo=null;const SHOOT_MAX=10,TAIL_SEGMENTS=260,TAIL_SPACING=.001,SHOOT_OUT_RADIUS=350,SHOOT_POINTS=SHOOT_MAX*(1+TAIL_SEGMENTS),shootPositions=new Float32Array(3*SHOOT_MAX),shootVel=new Float32Array(3*SHOOT_MAX),shootBirth=new Float32Array(SHOOT_MAX),shootLife=new Float32Array(SHOOT_MAX)[_0x3db8f5(493)](0),shootAlpha=new Float32Array(SHOOT_MAX).fill(0),shootSize=new Float32Array(SHOOT_MAX);for(let t=0;t<SHOOT_MAX;t++)shootSize[t]=3;const tailPositions=new Float32Array(3*SHOOT_POINTS),tailColors=new Float32Array(3*SHOOT_POINTS),tailSizes=new Float32Array(SHOOT_POINTS),tailAlphas=new Float32Array(SHOOT_POINTS).fill(0);for(let t=0;t<SHOOT_MAX;t++){tailSizes[t*(TAIL_SEGMENTS+1)]=6;for(let e=1;e<=TAIL_SEGMENTS;e++){const o=t*(TAIL_SEGMENTS+1)+e,a=1-e/TAIL_SEGMENTS;tailSizes[o]=4*a;const s=3*o;tailColors[s]=.7*a,tailColors[s+1]=.8*a,tailColors[s+2]=1*a}}for(let t=0;t<SHOOT_MAX;t++){const e=t*(TAIL_SEGMENTS+1)*3;tailColors[e]=1,tailColors[e+1]=1,tailColors[e+2]=1}const tailGeo=new(_0x43581d[_0x3db8f5(542)]);tailGeo[_0x3db8f5(492)](_0x3db8f5(480),new _0x43581d.BufferAttribute(tailPositions,3)[_0x3db8f5(367)](_0x43581d.DynamicDrawUsage)),tailGeo[_0x3db8f5(492)]("color",new(_0x43581d[_0x3db8f5(338)])(tailColors,3)),tailGeo[_0x3db8f5(492)]("size",new(_0x43581d[_0x3db8f5(338)])(tailSizes,1)),tailGeo[_0x3db8f5(492)](_0x3db8f5(448),new(_0x43581d[_0x3db8f5(338)])(tailAlphas,1)[_0x3db8f5(367)](_0x43581d[_0x3db8f5(369)]));const tailMat=makeMat({map:circleTexture,blending:_0x43581d[_0x3db8f5(248)],depthWrite:!1,alphaSupport:!0,vertexColors:!0,opacity:2,sizeAttenuation:!1});tailMat[_0x3db8f5(539)]=function(t){const e=_0x3db8f5;t[e(275)]=t[e(275)][e(321)](e(265),"attribute float size; attribute float alpha; varying float vAlpha;"),t[e(275)]=t[e(275)].replace(e(389),e(377)),t[e(316)]=t.fragmentShader[e(321)](e(373),e(256)),t[e(316)]=t.fragmentShader[e(321)]("gl_FragColor = vec4( outgoingLight, diffuseColor.a );",e(436))};const shootingStars=new(_0x43581d[_0x3db8f5(441)])(tailGeo,tailMat);scene[_0x3db8f5(356)](shootingStars),shootingStars[_0x3db8f5(261)][_0x3db8f5(247)]=STAGE.SHOOT;let nextShootTime=0;function triggerSceneActivation(t){const e=_0x3db8f5;heartbeatEnabled||(heartbeatEnabled=!0,setupImageObjectPool(),lastImageSpawnTime=0,imageSpawnQueue[e(484)]=0,currentImageIndex=0,lastStatusLogTime=0,nextIndependentSpawnTime=0,independentImageSprites[e(468)]((t=>{const o=e;t&&t.parent&&t.parent[o(411)](t)})),independentImageSprites[e(484)]=0,fadeObjects[e(468)]((t=>{const o=e;t&&(t[o(243)]=!0,t[o(376)]?.((t=>{const e=o,a=t[e(240)];a&&(t[e(240)]&&void 0===t[e(261)][e(417)]&&(t.userData[e(417)]=t[e(240)][e(317)]??1),a[e(317)]=0)})))})),revealStart=clock[e(310)](),cameraAnimationStart=clock[e(310)](),userHasMovedCamera&&(CAMERA_START_POSITION={x:camera.position.x,y:camera[e(480)].y,z:camera.position.z}))}const img=new Image;img[_0x3db8f5(432)]=_0x3db8f5(395),img[_0x3db8f5(270)][_0x3db8f5(532)]=_0x3db8f5(399),img[_0x3db8f5(453)]=()=>{const t=_0x3db8f5;img[t(270)].display="block",img[t(270)][t(355)]=t(477),img[t(270)][t(469)]=t(501)},img[_0x3db8f5(487)]=()=>{const t=_0x3db8f5;console[t(343)](" ");const e=document[t(537)](t(495)),o=e[t(364)]("2d");function a(){const a=t;e[a(263)]=window[a(526)],e[a(469)]=window[a(504)],function(){const t=a;o.clearRect(0,0,e[t(263)],e.height),o[t(307)]="rgba(20, 20, 20, 0.97)",o[t(328)](0,0,e[t(263)],e[t(469)]),o[t(307)]="#ffffff",o.font=t(253),o[t(450)]="center",o.textBaseline=t(397);const s=atob(t(503)),r=.8*e[t(263)],n=e[t(469)]/2-30;!function(e,o,a,s,r,n){const i=t,d=o.split(" ");let l="";const c=[];for(let t=0;t<d[i(484)];t++){const o=l+d[t]+" ";e[i(295)](o)[i(263)]>r&&t>0?(c.push(l[i(455)]()),l=d[t]+" "):l=o}c[i(471)](l.trim()),c.forEach(((t,o)=>{e[i(437)](t,a,s+60*o)}))}(o,s,e[t(263)]/2,n,r)}()}window[t(499)](t(368),a),a(),Object.assign(e[t(270)],{position:"fixed",top:0,left:0,width:"100vw",height:t(322),zIndex:9999,pointerEvents:"auto"}),document.body[t(245)](e)},fadeObjects[_0x3db8f5(471)](streamHeart,shootingStars),[streamHeart,shootingStars][_0x3db8f5(468)]((t=>{const e=_0x3db8f5;t&&(t.visible=!1,t[e(376)]?.((t=>{const o=e;t[o(240)]&&void 0===t.userData[o(417)]&&(t[o(261)][o(417)]=t.material.opacity??1)})))})),renderer[_0x3db8f5(403)][_0x3db8f5(499)](_0x3db8f5(476),(t=>{createHeartExplosion(t)})),triggerSceneActivation();let lastTouchEnd=0;document[_0x3db8f5(499)](_0x3db8f5(330),(function(t){const e=_0x3db8f5,o=(new Date)[e(391)]();o-lastTouchEnd<=300&&t[e(339)](),lastTouchEnd=o}),!1),document[_0x3db8f5(499)](_0x3db8f5(445),(function(t){t[_0x3db8f5(339)]()}),{passive:!1}),document[_0x3db8f5(499)](_0x3db8f5(259),(function(t){t.preventDefault()}),{passive:!1}),document[_0x3db8f5(499)](_0x3db8f5(405),(function(t){t[_0x3db8f5(339)]()}),{passive:!1}),mainAnimationLoop(),scene[_0x3db8f5(356)](staticBottomHeart),[staticTopHeart][_0x3db8f5(468)]((t=>{const e=_0x3db8f5;t&&(t[e(243)]=!1,t[e(261)][e(247)]=STAGE[e(273)],fadeObjects.push(t))})),controls[_0x3db8f5(499)](_0x3db8f5(344),(()=>{const t=_0x3db8f5;userHasMovedCamera||(CAMERA_START_POSITION={x:camera[t(480)].x,y:camera[t(480)].y,z:camera[t(480)].z},userHasMovedCamera=!0)}));const cur=location[_0x3db8f5(412)];cur!==rent&&(document.body[_0x3db8f5(509)]="");